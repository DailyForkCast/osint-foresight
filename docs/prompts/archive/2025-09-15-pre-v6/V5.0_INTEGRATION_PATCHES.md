# v5.0 Integration Patches
## Concrete Patches to Apply to v4.4 Master Prompts

**Purpose:** Direct patches to upgrade v4.4 ‚Üí v5.0
**Scope:** Universal enhancements for all 44 countries
**Date:** 2025-09-15

---

## üìù PATCH 1: GLOBAL POLICY BLOCK ADDITIONS

### Add to ChatGPT Master Prompt v4.4 (After existing POLICY section):

```yaml
  PROCUREMENT_TRACKING:  # v5.0 NEW
    cage_ncage_required: true
    nato_suppliers: true
    national_systems: true
    sources:
      - SAM.gov
      - USAspending.gov
      - CAGE/NCAGE lookup
      - NSPA/NCI Agency
      - National procurement portals

  EVIDENCE_INTEGRITY:  # v5.0 NEW
    auto_archive: true
    hash_verification: true
    archive_services:
      - Wayback Machine
      - Perma.cc
    sha256_required: "For all critical claims"

  NEGATIVE_EVIDENCE:  # v5.0 NEW
    track_not_found: true
    document_contradictions: true
    confidence_adjustment: "Downgrade on negatives"

  INFRASTRUCTURE_EXPOSURE:  # v5.0 NEW
    cloud_regions: true
    asn_tracking: true
    compute_allocations: true
    sbom_collection: true
```

---

## üìä PATCH 2: ENHANCED ARTIFACT SPECIFICATIONS

### Add to Artifact Contracts section:

```yaml
### Procurement Artifacts (NEW v5.0)
cage_ncage_registry.json        # US/NATO supplier codes
nato_suppliers.csv              # NATO program participants
award_overlaps.json             # US-Country contract overlaps

### Ownership & Funding (NEW v5.0)
ownership_chains.json           # LEI parent relationships
fts_grants.csv                  # EU Financial Transparency
national_project_codes.json     # Country-specific (CUP, etc.)

### Standards Tracking (NEW v5.0)
ballot_participation.json       # ISO/IEC/ETSI voting records
committee_memberships.csv       # Standards body roles
standards_influence_map.json    # Country positions mapped

### Evidence Integrity (NEW v5.0)
evidence_archive_log.json       # Wayback/Perma.cc records
negative_evidence.json          # Not found/contradictions
hash_verification.csv           # SHA-256 content hashes

### Infrastructure (NEW v5.0)
compute_allocations.json        # HPC/cloud usage
network_topology.json           # ASN/peering data
cloud_exposure.csv              # Provider/region mapping
```

---

## üîÑ PATCH 3: PHASE-SPECIFIC ENHANCEMENTS

### Phase 4 (Supply Chain) - Add to existing template:

```markdown
### v5.0 Procurement Enhancement
For each supplier, collect:
- **CAGE Code:** US Commercial and Government Entity code
- **NCAGE Code:** NATO Commercial and Government Entity code
- **Award IDs:** Specific contract numbers from SAM.gov
- **NATO Programs:** If NCAGE exists, link to NATO contracts
- **Plant Addresses:** Physical locations of production

#### New Fields for phase04_sub8_us_country_supply_overlap.json:
```json
{
  "supplier_name": "{{name}}",
  "cage_code": "{{5-char code or null}}",     // NEW v5.0
  "ncage_code": "{{5-char code or null}}",    // NEW v5.0
  "award_notice_url": "{{SAM.gov link}}",     // NEW v5.0
  "award_id": "{{contract number}}",          // NEW v5.0
  "nato_entity": {{true|false}},               // NEW v5.0
  "plant_address": "{{physical location}}",   // NEW v5.0
  "us_programs": ["{{list}}"],
  "china_exposure": "{{assessment}}"
}
```
```

### Phase 6 (Funding) - Add to existing template:

```markdown
### v5.0 Ownership Transparency
For each funded entity:
- **LEI:** Legal Entity Identifier
- **Parent Chain:** Full ownership via GLEIF
- **EU Grants:** FTS award IDs
- **National Codes:** Country-specific project IDs

#### New Fields for phase06_sub8_us_equity_links.json:
```json
{
  "entity": "{{name}}",
  "lei": "{{20-char LEI}}",                    // NEW v5.0
  "lei_parent_chain": [                        // NEW v5.0
    {"lei": "{{parent}}", "name": "{{name}}", "percent": {{ownership}}}
  ],
  "ownership_basis": "{{filing|registry|press}}",  // NEW v5.0
  "fts_award_id": "{{EU grant ID}}",           // NEW v5.0
  "national_project_code": "{{CUP/other}}",    // NEW v5.0
  "us_connection": "{{via parent|direct|none}}"
}
```
```

### Phase 7 (International Links) - Add:

```markdown
### v5.0 Standards Participation
For standards bodies:
- **Ballot Participation:** Track voting records
- **Committee Roles:** Document leadership positions
- **National Positions:** Country stances on key standards

#### New Fields for phase07_sub7_us_country_standards_roles.json:
```json
{
  "standard": "{{ISO/IEC/ETSI number}}",
  "ballot_id": "{{ballot reference}}",         // NEW v5.0
  "vote_position": "{{approve|reject|abstain}}",  // NEW v5.0
  "agenda_url": "{{meeting documents}}",       // NEW v5.0
  "committee_collab": {{true|false}},          // NEW v5.0
  "china_position": "{{China's vote/role}}",
  "us_alignment": "{{aligned|opposed|neutral}}"
}
```
```

### Phase 9 (Strategic Posture) - Add:

```markdown
### v5.0 Negative Evidence Tracking
Document when expected evidence is NOT found:

#### NEW ARTIFACT: phase09_sub12_negative_evidence.json
```json
{
  "claim": "{{assertion to verify}}",
  "searched_sources": ["{{list of sources checked}}"],
  "result": "none|contradiction|partial",
  "notes": "{{explanation}}",
  "urls": ["{{archive links}}"],
  "confidence_impact": "{{how this affects scoring}}"
}
```
```

### Phase 11 (Foresight) - Add:

```markdown
### v5.0 Infrastructure Exposure
Track compute and network dependencies:

#### New Fields for phase11_sub5_compute_data_exposure.json:
```json
{
  "institution": "{{name}}",
  "asn": "{{AS number}}",                     // NEW v5.0
  "cloud_region": "{{AWS/Azure/GCP region}}",  // NEW v5.0
  "data_residency_note": "{{compliance note}}", // NEW v5.0
  "sbom_url": "{{software bill of materials}}", // NEW v5.0
  "compute_allocation": "{{HPC core-hours}}",
  "acknowledged_in": ["{{paper DOIs}}"]
}
```
```

---

## üîí PATCH 4: EVIDENCE INTEGRITY PROTOCOL

### Add to all phases (Evidence Requirements section):

```python
# v5.0 Evidence Integrity Protocol

def archive_critical_evidence(url, claim_id):
    """
    Archive and hash all critical URLs
    """
    # Archive to Wayback
    archive_url = wayback_machine_save(url)

    # Get content for hashing
    content = fetch_content(url)
    content_hash = hashlib.sha256(content.encode()).hexdigest()

    # Store in evidence log
    evidence_record = {
        "claim_id": claim_id,
        "original_url": url,
        "archive_url": archive_url,
        "content_sha256": content_hash,
        "archived_date": datetime.now().isoformat(),
        "verification_status": "preserved"
    }

    append_to_log("evidence_archive_log.json", evidence_record)
    return archive_url

# Apply to all critical claims
if claim.strategic_value in ["CRITICAL", "HIGH"]:
    claim.archive_url = archive_critical_evidence(claim.source_url, claim.id)
```

---

## üì¶ PATCH 5: NEW DATA SOURCES

### Add to Data Sources section (all phases):

```yaml
procurement_sources:
  us_nato:
    - name: "SAM.gov"
      url: "https://sam.gov"
      data: "Contract awards, entity registrations"
    - name: "CAGE Code Lookup"
      url: "https://cage.dla.mil"
      data: "US supplier identifiers"
    - name: "USAspending.gov"
      url: "https://usaspending.gov"
      data: "Federal spending data"
    - name: "NSPA"
      url: "https://www.nspa.nato.int"
      data: "NATO procurement"

ownership_funding:
  - name: "GLEIF"
    url: "https://www.gleif.org"
    data: "LEI relationships, ownership chains"
  - name: "EU FTS"
    url: "https://ec.europa.eu/budget/fts"
    data: "EU grant recipients"
  - name: "EDGAR"
    url: "https://www.sec.gov/edgar"
    data: "US parent company filings"

standards_bodies:
  - name: "ISO"
    url: "https://www.iso.org"
    data: "Ballots, committee membership"
  - name: "ETSI"
    url: "https://www.etsi.org"
    data: "Working groups, voting records"
  - name: "NATO Standardization"
    url: "https://nso.nato.int"
    data: "STANAG adoption"

infrastructure:
  - name: "PeeringDB"
    url: "https://www.peeringdb.com"
    data: "Network peering, ASN relationships"
  - name: "RIPEstat"
    url: "https://stat.ripe.net"
    data: "IP allocations, routing"
```

---

## üéØ PATCH 6: VALIDATION RULES UPDATE

### Add to Quality Gates section:

```yaml
v5.0_validation_requirements:
  procurement:
    - "CAGE/NCAGE lookup attempted for all suppliers"
    - "NATO program links documented"
    - "Award IDs traced to SAM.gov"

  ownership:
    - "LEI parent chains resolved"
    - "Ultimate beneficial owner identified"
    - "EU funding tracked via FTS"

  standards:
    - "Ballot positions documented"
    - "Committee roles identified"
    - "China alignment assessed"

  evidence:
    - "Critical URLs archived"
    - "SHA-256 hashes stored"
    - "Negative evidence logged"

  infrastructure:
    - "Cloud regions identified"
    - "ASN ownership verified"
    - "Compute allocations tracked"
```

---

## üîß IMPLEMENTATION COMMANDS

### For ChatGPT:
```markdown
When implementing v5.0:
1. Add CAGE/NCAGE fields to all supplier records
2. Include LEI parent chains in ownership analysis
3. Track standards ballot participation
4. Archive all critical URLs with Wayback
5. Log negative evidence systematically
```

### For Claude Code:
```python
# Add to initialization
import hashlib
from wayback import WaybackMachine

def init_v5_tracking():
    trackers = {
        "cage_ncage": CageNcageResolver(),
        "lei_chains": GleifAPI(),
        "fts_grants": EuFtsClient(),
        "archiver": WaybackArchiver(),
        "hasher": SHA256Hasher()
    }
    return trackers

# Apply to all phases
for phase in all_phases:
    phase.add_procurement_tracking()
    phase.add_ownership_chains()
    phase.add_evidence_integrity()
    phase.track_negative_evidence()
```

---

## ‚úÖ QUICK VALIDATION CHECK

### v5.0 Additions Checklist:
- [ ] CAGE/NCAGE codes in Phase 4
- [ ] LEI parent chains in Phase 6
- [ ] Ballot tracking in Phase 7
- [ ] Negative evidence in Phase 9
- [ ] Cloud/ASN in Phase 11
- [ ] Evidence archiving throughout
- [ ] SHA-256 hashing for critical claims

---

## üéØ BOTTOM LINE

**v5.0 adds systematic tracking of:**
1. US/NATO procurement overlaps via CAGE/NCAGE
2. Ownership transparency via LEI chains
3. Standards influence via ballot participation
4. Evidence preservation via archiving/hashing
5. Confidence calibration via negative evidence

**All using free, open sources applicable to all 44 countries.**

---

*Apply these patches to v4.4 master prompts for v5.0 capabilities*
